<!DOCTYPE html>
<html>
<head>
    <title>URL Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
</head>
<body>
    <div class="container">
        <!-- Main Content -->
        <div class="main-content">
            <h1>URL Manager</h1>
            
            <form action="/add" method="POST">
                <input type="url" name="url" placeholder="https://example.com" required>
                
                <!-- Tag Selection -->
                <div class="tag-selection">
                    <label>Add Tags:</label>
                    <div class="tag-buttons">
                        <button type="button" class="tag-btn work" data-tag="work">Work</button>
                        <button type="button" class="tag-btn programming" data-tag="programming">Programming</button>
                        <button type="button" class="tag-btn research" data-tag="research">Research</button>
                        <button type="button" class="tag-btn personal" data-tag="personal">Personal</button>
						<button type="button" class="tag-btn news" data-tag="news">News</button>
                    </div>
                    <input type="hidden" name="tags" id="selected-tags">
                    <div id="selected-tags-display"></div>
                </div>
                
                <button type="submit">Add URL</button>
            </form>

            
			
			
			<!-- Saved URLs Section -->
{% if urls %}
    {% for item in urls %}
    <div class="url-item">
        <div class="url-title">{{ item.title }}</div>
        <a href="{{ item.url }}" target="_blank" class="url-link">{{ item.url }}</a>
        
        <!-- Display tags with remove links -->
        <div class="url-tags">
            {% for tag in item.tags %}
            <span class="tag-pill tag-{{ tag }}">
                {{ tag }}
                <!-- Use item.id instead of url_index -->
                <a href="/remove-tag/{{ item.id }}/{{ tag }}" class="remove-tag-btn">Ã—</a>
            </span>
            {% endfor %}
        </div>
        
        <br>
        <!-- Buttons use item.id -->
        <form action="/delete/{{ item.id }}" method="POST" style="display: inline;">
            <button type="submit" class="delete-btn" 
                    onclick="return confirm('Delete this URL?')">Delete</button>
        </form>
        
        <form action="/archive/{{ item.id }}" method="POST" style="display: inline;">
            <button type="submit" class="archive-btn"
                    onclick="return confirm('Archive this URL?')">Archive</button>
        </form>
        
        <button class="copy-btn" data-url="{{ item.url }}">Copy URL</button>
    </div>
    {% endfor %}
{% else %}
    <p>No URLs added yet.</p>
{% endif %}

           


		   <!-- Archived URLs Section -->
<h2>Archived URLs</h2>

{% if archived_urls %}
    {% for item in archived_urls %}
    <div class="url-item archived">
        <div class="url-title">{{ item.title }}</div>
        <a href="{{ item.url }}" target="_blank" class="url-link">{{ item.url }}</a>
        
        <!-- Display tags (read-only for archived) -->
        {% if item.tags %}
        <div class="url-tags">
            {% for tag in item.tags %}
            <span class="tag-pill tag-{{ tag }}">
                {{ tag }}
            </span>
            {% endfor %}
        </div>
        {% endif %}
        
        <br>
        <!-- Only Unarchive Button -->
        <form action="/unarchive/{{ item.id }}" method="POST" style="display: inline;">
            <button type="submit" class="unarchive-btn">Unarchive</button>
        </form>
    </div>
    {% endfor %}
{% else %}
    <p>No archived URLs.</p>
{% endif %}
        </div>

        <!-- Tag Sidebar -->
        <div class="tag-sidebar">
            <h3>TAGS</h3>
            <div class="tag-cloud">
                {% for tag in ['work', 'programming', 'research', 'personal','news'] %}
                    {% set tag_urls = [] %}
                    {% for url in urls %}
                        {% if tag in url.tags %}
                            {% set _ = tag_urls.append(url) %}
                        {% endif %}
                    {% endfor %}
                    
                    {% if tag_urls %}
                    <div class="tag-sidebar-item">
                        <button class="tag-sidebar-btn tag-{{ tag }}" data-tag="{{ tag }}">
                            {{ tag }} ({{ tag_urls|length }})
                        </button>
                        <div class="tag-dropdown" id="dropdown-{{ tag }}">
                            {% for url in tag_urls %}
                            <div class="dropdown-url">
                                <a href="{{ url.url }}" target="_blank">{{ url.title }}</a>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</body>
</html>